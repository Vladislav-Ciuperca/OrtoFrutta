sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/m/MessageToast"],function(t,e,i,o,s){"use strict";return t.extend("gestionalerepartofruttacoop.controller.View1",{onInit(){this.AddModel=new sap.ui.model.json.JSONModel;this.getView().setModel(this.AddModel,"AddProducts");this.getView().getModel("AddProducts").setProperty("/Prodotti",[]);console.log(this.getView().getModel("AddProducts").getProperty("/Prodotti",[]));this.getRouter().getRoute("RouteView1").attachPatternMatched(this._gestioniProdottiMatched,this);this.oModel=this.getView().getModel("AddProducts");this.x=0},stampaNumero:function(t){console.log("sto stampando e poi",t)},moltiplicaNumero:function(t,e){console.log("moltiplicato = ",t*e)},aggiungi:function(){if(this.x%5==0){this.stampaNumero(this.x)}this.x++;console.log(this.x)},sottrai:function(){if(this.x%2==0){this.moltiplicaNumero(this.x,3)}console.log(this.x);this.x--},onEdit:function(){console.log(this.getView().getModel("AddProducts").getProperty("/Matcher"));this.byId("modifica").setVisible(false);this.byId("undo").setVisible(true);this.byId("barra").setVisible(true);this.byId("input_categoria").setVisible(true);this.byId("text_categoria").setVisible(false);this.byId("input_nome").setVisible(true);this.byId("text_nome").setVisible(false);this.byId("input_quanita").setVisible(true);this.byId("text_quantita").setVisible(false);this.byId("input_prezzo").setVisible(true);this.byId("text_prezzo").setVisible(false);this.byId("input_sconto").setVisible(true);this.byId("text_sconto").setVisible(false);this.byId("input_data").setVisible(true);this.byId("text_data").setVisible(false);this.byId("input_origine").setVisible(true);this.byId("text_origine").setVisible(false);this.byId("delete").setVisible(true)},onSave:function(){this.byId("modifica").setVisible(true);this.byId("undo").setVisible(false);this.byId("input_categoria").setVisible(false);this.byId("text_categoria").setVisible(true);this.byId("input_nome").setVisible(false);this.byId("text_nome").setVisible(true);this.byId("input_quanita").setVisible(false);this.byId("text_quantita").setVisible(true);this.byId("input_prezzo").setVisible(false);this.byId("text_prezzo").setVisible(true);this.byId("input_sconto").setVisible(false);this.byId("text_sconto").setVisible(true);this.byId("input_data").setVisible(false);this.byId("text_data").setVisible(true);this.byId("input_origine").setVisible(false);this.byId("text_origine").setVisible(true);this.byId("barra").setVisible(false);this.byId("delete").setVisible(false)},onUndo:function(){var t=this;var e=this.getView().getModel("AddProducts");var i=e.getProperty("/Prodotti");var s=this.savedData;var d=JSON.stringify(i)===JSON.stringify(s);console.log(i);console.log(s);console.log(d);if(d){console.log("Nessuna modifica");this.undoShit()}else{console.log("Hai fatto modifiche");o.confirm("Vuoi annulare le modifiche?",{icon:o.Icon.WARNING,title:"Annulla",actions:[o.Action.OK,o.Action.CANCEL],emphasizedAction:o.Action.OK,dependentOn:this.getView(),onClose:function(e){if(e===o.Action.OK){console.log("hai premuto ok zio");t.undoShit()}else if(o.Action.CANCEL){console.log("hai premuto cancel")}}})}},undoShit:function(){this.byId("modifica").setVisible(true);this.byId("undo").setVisible(false);this.byId("barra").setVisible(false);this._gestioniProdottiMatched();this.byId("input_categoria").setVisible(false);this.byId("text_categoria").setVisible(true);this.byId("input_nome").setVisible(false);this.byId("text_nome").setVisible(true);this.byId("input_quanita").setVisible(false);this.byId("text_quantita").setVisible(true);this.byId("input_prezzo").setVisible(false);this.byId("text_prezzo").setVisible(true);this.byId("input_sconto").setVisible(false);this.byId("text_sconto").setVisible(true);this.byId("input_data").setVisible(false);this.byId("text_data").setVisible(true);this.byId("input_origine").setVisible(false);this.byId("text_origine").setVisible(true);this.byId("delete").setVisible(false)},onDelete:function(t){let e=this;var i=t.getSource().getParent().sId.split("row")[t.getSource().getParent().sId.split("row").length-1];let s=this.getView().getModel("AddProducts").getProperty("/Prodotti")[i].prodotto;console.log(s);o.confirm("Stai cancellando l' elemento "+s,{icon:o.Icon.WARNING,title:"Elimina",actions:[o.Action.OK,o.Action.CANCEL],emphasizedAction:o.Action.OK,dependentOn:this.getView(),onClose:function(i){if(i===o.Action.OK){var s=t.getSource().getParent().sId.split("row")[t.getSource().getParent().sId.split("row").length-1];console.log(s);console.log("sto cancellando",e.getView().getModel("AddProducts").getProperty("/Prodotti")[s]);e.getView().getModel("AddProducts").getProperty("/Prodotti").splice(s,1);console.log(e.getView().getModel("AddProducts").getProperty("/Prodotti"));var d=e.getView().getModel("AddProducts").getProperty("/Prodotti");e.getView().getModel("AddProducts").setProperty("/Prodotti",d);console.log("hai premuito ok amore")}else if(i===o.Action.CANCEL){console.log("non te ghe premuo na sega tesoro")}}})},add:function(){this.byId("barra").setVisible(true);const t={categoria:"",prodotto:"",giacenza:"",prezzo_unitario:"",sconto:"",data_aggiornamento:(new Date).toISOString(),origine:""};this.getView().getModel("AddProducts").getProperty("/Prodotti").push(t);let e=this.getView().getModel("AddProducts").getProperty("/Prodotti");this.getView().getModel("AddProducts").setProperty("/Prodotti",e);console.log(this.getView().getModel("AddProducts").getProperty("/Prodotti"));this.byId("modifica").firePress()},getRouter:function(){return sap.ui.core.UIComponent.getRouterFor(this)},_gestioniProdottiMatched:function(){var t=this.getOwnerComponent().getModel().sServiceUrl;var e=this;e.makeAjaxRequest(t+"fruttarolo",function(t){e.getView().getModel("AddProducts").setProperty("/Prodotti",t.value);e.savedData=JSON.parse(JSON.stringify(e.oModel.getProperty("/Prodotti")))}.bind(e),function(t){}.bind(e))},makeAjaxRequest:function(t,e,i){let o=this;jQuery.ajax({url:t,dataType:"json",success:function(t){if(typeof e==="function"){e(t);o.getView().getModel("AddProducts").setProperty("/Matcher",t.value)}},error:function(t){if(typeof i==="function"){i(t)}}})},getArray:function(){console.log(this.getView().getModel("AddProducts").getProperty("/Prodotti"))}})});
//# sourceMappingURL=View1.controller.js.map